<!DOCTYPE html>
<html>
  <head>
    <title>App Launcher</title>
  </head>
  <body>
    <h1>Linuxwave GUI</h1>
    <p> This is my attempt at making a GUI for linuxwave. Linuxwave is a commmand-line tool to generate music from bytes of various files, the default being /dev/urandom. The GitHub page for it is at <a href="https://github.com/orhun/linuxwave/">https://github.com/orhun/linuxwave/</a>. <br>
    To use this you simply need to have linuxwave and sox installed on your system and have this app running. <br>
    You can install them with <pre>sudo apt install sox</pre>, and for linuxwave you can either compile it from source or download a precompiled binary from the releases section of the GitHub page. <br>
    After that, you can use the buttons below to launch linuxwave with various options of your choice!
    </p>
    <input type="text" id="bpm" placeholder="Enter desired bpm" />
    <button onclick="sendCustomCommand()">Run Linuxwave</button>
    <script>
      document.querySelectorAll("button[data-launch]").forEach((button) => {
        button.addEventListener("click", () => {
          const command = button.getAttribute("data-launch");
          window.api.launchApp(command);
        });
      });
      const pitchDownSemis = (newRate, baseRate) =>
        12 * Math.log2(newRate / baseRate);
      function sendCustomCommand() {
        const sampleRate = (document.getElementById("bpm").value / 144) * 24000;
        const pitch = -100 * pitchDownSemis(sampleRate, 24000);
        console.log(sampleRate);
        const command = `linuxwave -r ${sampleRate} && sox output.wav -r 44100 output2.wav pitch ${pitch} && rm output.wav && mv output2.wav output.wav`;
        if (command.trim()) {
          window.api.launchApp(command);
        }
      }
    </script>
  </body>
</html>
